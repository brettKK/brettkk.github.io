<!DOCTYPE html>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css">
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<html lang="zh-cn">
  <head>
    <title>å®¹å™¨ &amp; k8s | brettkk</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="å®¹å™¨ ğŸ”—dockeræ¶æ„ï¼Œé•œåƒï¼Œå®¹å™¨ï¼Œç½‘ç»œï¼Œå­˜å‚¨ã€‚ å®¹å™¨è§„èŒƒOC">
<meta name="generator" content="Hugo 0.103.1" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link href="https://cdn.bootcss.com/highlight.js/9.15.10/styles/zenburn.min.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<link rel="stylesheet" href="http://brettkk.github.io/css/syntax.css" />


<link rel="stylesheet" href="/css/style.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />




  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>




  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">â†</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">å®¹å™¨ &amp; k8s</h1>

    <div class="tip">
        <time datetime="2021-06-27 11:33:56 &#43;0800 CST">Jun 27, 2021</time>
        <span class="split">
          Â·
        </span>
        <span>
          2178 words
        </span>
        <span class="split">
          Â·
        </span>
        <span>
          5 minute read
        </span>
    </div>

    
    
        
  
    <aside class="toc">
      <details>
          <summary>Table of Contents
          </summary>
          <div>
              <nav id="TableOfContents">
  <ul>
    <li><a href="#å®¹å™¨">å®¹å™¨</a>
      <ul>
        <li><a href="#å®¹å™¨æŠ€æœ¯å†å²">å®¹å™¨æŠ€æœ¯å†å²</a></li>
        <li><a href="#dockerçš„å®ç°">dockerçš„å®ç°</a>
          <ul>
            <li><a href="#å®¹å™¨è¿è¡Œæ—¶containerd">å®¹å™¨è¿è¡Œæ—¶containerd</a></li>
          </ul>
        </li>
        <li><a href="#runc-ociæ ‡å‡†">runc ï¼ˆOCIæ ‡å‡†ï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#k8sæ¶æ„">k8sæ¶æ„</a>
      <ul>
        <li><a href="#åˆ›å»ºpodçš„ä¸»è¦æµç¨‹">åˆ›å»ºpodçš„ä¸»è¦æµç¨‹</a></li>
        <li><a href="#è¯·æ±‚è®¿é—®podçš„æµç¨‹">è¯·æ±‚è®¿é—®podçš„æµç¨‹</a></li>
        <li><a href="#workloadç±»å‹-statefulset">workloadç±»å‹ï¼Œ statefulset</a></li>
        <li><a href="#pv-pvc-åŠ¨æ€pvçš„å®ç°">pv, pvc, åŠ¨æ€pvçš„å®ç°</a></li>
        <li><a href="#å®æ“">å®æ“</a></li>
        <li><a href="#è®¿é—®è€…æ¨¡å¼">è®¿é—®è€…æ¨¡å¼</a></li>
      </ul>
    </li>
    <li><a href="#å¾®æœåŠ¡ä¸service-mesh">å¾®æœåŠ¡ä¸service mesh</a></li>
    <li><a href="#laas">laas</a></li>
  </ul>
</nav>
          </div>
      </details>
    </aside>
  


    


    <div class="content">
      <h1 id="å®¹å™¨">å®¹å™¨ <a href="#%e5%ae%b9%e5%99%a8" class="anchor">ğŸ”—</a></h1><p>dockeræ¶æ„ï¼Œé•œåƒï¼Œå®¹å™¨ï¼Œç½‘ç»œï¼Œå­˜å‚¨ã€‚</p>
<p>å®¹å™¨è§„èŒƒOCIã€‚ runtime ï¼ˆlxcï¼Œ runcï¼Œrktï¼‰ï¼Œé•œåƒæ ¼å¼ã€‚</p>
<p>é›†è£…ç®±è¿è¾“è´§ç‰©ï¼Œdockerè¿è¾“ç§»æ¤è½¯ä»¶ã€‚</p>
<p>é•œåƒï¼Œå®¹å™¨å±‚ï¼ˆå¯è¯»å¯å†™ï¼‰ï¼Œé•œåƒå±‚ï¼ˆåªè¯»ï¼‰ã€‚</p>
<p>docker run -it ubuntuã€‚ ä»¥äº¤äº’æ¨¡å¼è¿›å…¥å®¹å™¨å¹¶æ‰“å¼€ç»ˆç«¯ã€‚</p>
<p>-d åå°è¿è¡Œã€‚</p>
<h2 id="å®¹å™¨æŠ€æœ¯å†å²">å®¹å™¨æŠ€æœ¯å†å² <a href="#%e5%ae%b9%e5%99%a8%e6%8a%80%e6%9c%af%e5%8e%86%e5%8f%b2" class="anchor">ğŸ”—</a></h2><p>1979å¹´ chroot è®¾ç½®è¿›ç¨‹è®¿é—®çš„æ ¹ç›®å½•</p>
<p>2006å¹´ google ç»™kernelæä¾›Control Groups</p>
<p>2008å¹´ LXC ç¬¬ä¸€ä¸ªå®¹å™¨ç®¡ç†æ–¹æ¡ˆ</p>
<p>2015å¹´ google æä¾›libcontainer</p>
<p>2013å¹´ å®¹å™¨ç®¡ç†äº§å“docker</p>
<hr>
<p>dockerç®€åŒ–æœåŠ¡çš„ç®¡ç†ï¼Œç±»ä¼¼systemd, supervisor; ä½†æ›´åŠ é‡è¦çš„é•œåƒæŠ€æœ¯ã€‚</p>
<pre tabindex="0"><code>docker run hello-world
 1. The Docker client -&gt; Docker daemon.
 2. The Docker daemon pulled the &#34;hello-world&#34; image from the Docker Hub.(arm64v8)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.
</code></pre><h2 id="dockerçš„å®ç°">dockerçš„å®ç° <a href="#docker%e7%9a%84%e5%ae%9e%e7%8e%b0" class="anchor">ğŸ”—</a></h2><p>unionFS, åˆ†å±‚é•œåƒå®ç°ã€‚<code>unionFS</code>å¯ä»¥æŠŠæ–‡ä»¶ç³»ç»Ÿä¸Šçš„å¤šä¸ªç›®å½•å†…å®¹è”åˆæŒ‚è½½åˆ°åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œè€Œç›®å½•çš„ç‰©ç†ä½ç½®æ˜¯åˆ†å¼€çš„ã€‚<br></p>
<p>namespace</p>
<p>cgroup</p>
<h3 id="å®¹å™¨è¿è¡Œæ—¶containerd">å®¹å™¨è¿è¡Œæ—¶containerd <a href="#%e5%ae%b9%e5%99%a8%e8%bf%90%e8%a1%8c%e6%97%b6containerd" class="anchor">ğŸ”—</a></h3><pre tabindex="0"><code>		docker client
		docker daemon
		containerd
	containerd-shim   containerd-shim
	runc(OCIæ ‡å‡†)	          runc
</code></pre><h2 id="runc-ociæ ‡å‡†">runc ï¼ˆOCIæ ‡å‡†ï¼‰ <a href="#runc-oci%e6%a0%87%e5%87%86" class="anchor">ğŸ”—</a></h2><p>â€ƒâ€ƒOCIï¼ˆOpen Container Initiativeï¼‰å³å¼€æ”¾çš„å®¹å™¨è¿è¡Œæ—¶è§„èŒƒï¼Œ (runtime-spec)[https://github.com/opencontainers/runtime-spec/blob/main/runtime.md]ï¼šå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†; (image-spec)[https://github.com/opencontainers/image-spec/blob/main/spec.md]: é•œåƒçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚ <br>
â€ƒâ€ƒå®ç°OCIæ ‡å‡†çš„å®¹å™¨è¿è¡Œæ—¶æœ‰runcï¼Œkata<br>
â€ƒâ€ƒruncç”¨æ¥åˆ›å»ºå’Œè¿è¡Œå®¹å™¨ï¼Œcontainerdä½œä¸ºå¸¸é©»è¿›ç¨‹ç”¨æ¥ç®¡ç†å®¹å™¨<br>
â€ƒâ€ƒ<code>docker start</code> -&gt; <code>containerd api</code> -&gt; <code>containerd shim</code> -&gt; <code>runc create, init, start</code> <br>
opencontainers/runc/create.go#<code>var createCommand = cli.Command{...}</code></p>
<hr>
<h1 id="k8sæ¶æ„">k8sæ¶æ„ <a href="#k8s%e6%9e%b6%e6%9e%84" class="anchor">ğŸ”—</a></h1><p><img src="/cloud_native/k8s_architecture.png" width = "600" /><br></p>
<ul>
<li>
<p>api server</p>
</li>
<li>
<p>scheduler</p>
</li>
<li>
<p>controler</p>
</li>
<li>
<p>kubelet</p>
<ul>
<li>podç®¡ç†</li>
<li>å®¹å™¨å¥åº·æ£€æŸ¥ LivenessProbe ä¸ReadinessProbe</li>
<li>å®¹å™¨ç›‘æ§  é€šè¿‡cAdvisorè·å–èŠ‚ç‚¹å’Œå®¹å™¨çš„æ•°æ®</li>
</ul>
</li>
<li>
<p>proxy</p>
</li>
<li>
<p>pod ï¼ˆè¿›ç¨‹ç»„ï¼‰</p>
<ul>
<li>æ‰“å¼€å®¹å™¨ä¹‹é—´çš„éš”ç¦»æ€§ï¼Œä¸¤ä¸ªæ–¹å‘ ç½‘ç»œå’Œå­˜å‚¨æ¥é€šä¿¡ã€‚
<ul>
<li>Infra container å°å®¹å™¨æ¥å…±äº«æ•´ä¸ª Pod çš„  Network Namespace, ç›´æ¥ä½¿ç”¨localhostè¿›è¡Œé€šä¿¡ã€‚</li>
<li>å®¿ä¸»æœºä¸Šçš„ç›®å½•mountåˆ°podçš„å®¹ç§¯é‡Œçš„æ–‡ä»¶ç›®å½•ä¸‹ï¼Œå®ç°è¯»å†™æ–‡ä»¶é€šä¿¡ã€‚</li>
</ul>
</li>
<li>ä¸€ç»„ç®¡ç†å…³ç³»ç´§å¯†çš„å®¹å™¨ï¼ˆè¿›ç¨‹ï¼‰ï¼Œä¸ä¸šåŠ¡å®¹å™¨éœ€è¦çš„side carè¾…åŠ©å®¹ç§¯ï¼ˆæ—¥å¿—æ”¶é›†ï¼Œservice meshï¼Œ åº”ç”¨ç›‘æ§ï¼‰</li>
<li>å®¹å™¨ä¸åªcontainerdï¼Œk8séœ€è¦åŸºäºcontaineråšä¸€æ­¥æŠ½è±¡container runtime interfz</li>
<li>è®¾è®¡æ¨¡å¼æœ¬è´¨ï¼šè§£è€¦ å¤ç”¨</li>
</ul>
</li>
<li>
<p>service</p>
<ul>
<li>ä¸€ä¸ªsvcæ˜¯ä¸€ä¸ªå¾®æœåŠ¡ï¼Œä¹Ÿæ˜¯ä¸€ç»„prodï¼Œé€šè¿‡label robinå®ç°IPè´Ÿè½½å‡è¡¡</li>
</ul>
</li>
<li>
<p>volume</p>
</li>
</ul>
<h2 id="åˆ›å»ºpodçš„ä¸»è¦æµç¨‹">åˆ›å»ºpodçš„ä¸»è¦æµç¨‹ <a href="#%e5%88%9b%e5%bb%bapod%e7%9a%84%e4%b8%bb%e8%a6%81%e6%b5%81%e7%a8%8b" class="anchor">ğŸ”—</a></h2><ul>
<li>clientæäº¤podçš„yamlé…ç½®æ–‡ä»¶åˆ°k8s-apiserver</li>
<li>apiserveré€šçŸ¥ç»™controller-manageråˆ›å»ºä¸€ä¸ªèµ„æºå¯¹è±¡</li>
<li>controller-manageré€šè¿‡apiserverå°†podçš„é…ç½®ä¿¡æ¯å­˜å‚¨åœ¨etcdä¸­</li>
<li>k8s-scheduleræ£€æµ‹åˆ°podä¿¡æ¯å¼€å§‹è°ƒåº¦ï¼Œé€‰æ‹©åˆé€‚çš„èŠ‚ç‚¹ï¼Œå°†podçš„èµ„æºé…ç½®å‘åˆ°èŠ‚ç‚¹ä¸Šçš„kubeletç»„ä»¶</li>
<li>kubeletæ ¹æ®èµ„æºé…ç½®å•è¿è¡Œpodï¼Œå°†podçš„è¿è¡Œä¿¡æ¯è¿”å›ç»™scheduler, å­˜å‚¨åˆ°etcdä¸­</li>
</ul>
<p>operator</p>
<h2 id="è¯·æ±‚è®¿é—®podçš„æµç¨‹">è¯·æ±‚è®¿é—®podçš„æµç¨‹ <a href="#%e8%af%b7%e6%b1%82%e8%ae%bf%e9%97%aepod%e7%9a%84%e6%b5%81%e7%a8%8b" class="anchor">ğŸ”—</a></h2><p>hostNetworkï¼š å ç”¨ç‰¹å®šå®¿ä¸»æœºä¸Šçš„ç‰¹å®šç«¯å£ã€‚
hostPortï¼š å°†å®¹å™¨çš„ç«¯å£ä¸nodeä¸Šçš„ç«¯å£åšæ˜ å°„</p>
<p>ç½‘ç»œ</p>
<h2 id="workloadç±»å‹-statefulset">workloadç±»å‹ï¼Œ statefulset <a href="#workload%e7%b1%bb%e5%9e%8b-statefulset" class="anchor">ğŸ”—</a></h2><h2 id="pv-pvc-åŠ¨æ€pvçš„å®ç°">pv, pvc, åŠ¨æ€pvçš„å®ç° <a href="#pv-pvc-%e5%8a%a8%e6%80%81pv%e7%9a%84%e5%ae%9e%e7%8e%b0" class="anchor">ğŸ”—</a></h2><h2 id="å®æ“">å®æ“ <a href="#%e5%ae%9e%e6%93%8d" class="anchor">ğŸ”—</a></h2><p>å®‰è£…å‘½ä»¤è¡Œå·¥å…·ï¼šbrew install kubernetes-cli</p>
<p>å®‰è£…k8sï¼š brew cask instsall minikube</p>
<p>å®‰è£…å®Œminikubeåï¼Œminikube startå¯åŠ¨ä¸€ä¸ªk8sé›†ç¾¤ã€‚</p>
<pre tabindex="0"><code>$ minikube start
// åœ¨macos archä¸Šerrorã€‚

è§£å†³åŠæ³•ï¼š  
$ docker pull kicbase/stable:v0.0.34
$ minikube start --vm-driver=docker --base-image=&#34;kicbase/stable:v0.0.34&#34; --image-mirror-country=&#39;cn&#39; --image-repository=&#39;registry.cn-hangzhou.aliyuncs.com/google_containers&#39; --kubernetes-version=v1.23.8

https://github.com/kubernetes/minikube/issues/14477
</code></pre><p>minikube statusæŸ¥çœ‹å¯åŠ¨æƒ…å†µã€‚</p>
<pre tabindex="0"><code>$ minikube dashboard

dashboardå¯åŠ¨ä¸äº†...

$ minikube dashboard --url --alsologtostderr -v=1

I1007 17:53:29.191813   80782 dashboard.go:212] http://127.0.0.1:56602/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/ response: &lt;nil&gt; &amp;{Status:503 Service Unavailable StatusCode:503 Proto:HTTP/1.1 ProtoMajor:1 ProtoMinor:1 Header:map[Audit-Id:[88044732-eedc-4974-bb88-f81b1ff242c7] Cache-Control:[no-cache, private] Content-Length:[182] Content-Type:[application/json] Date:[Fri, 07 Oct 2022 09:53:29 GMT]] Body:0x14000113000 ContentLength:182 TransferEncoding:[] Close:false Uncompressed:false Trailer:map[] Request:0x14000daff00 TLS:&lt;nil&gt;}

$ minikube dashboard --url
</code></pre><pre tabindex="0"><code>$ curl -L https://git.io/getLatestIstio | sh -

$ export PATH=$PWD/bin:$PATH
å°†istioctlå‘½ä»¤è¡Œå·¥å…·çš„è·¯å¾„åŠ å…¥pathä¸­ã€‚
</code></pre><p>å®‰è£…Helmï¼ˆk8sä¸‹çš„åŒ…ç®¡ç†å·¥å…·ï¼‰ï¼Œ  brew install Kubernetes-helm</p>
<p>åŸºäºhelm å®‰è£…istioã€‚</p>
<h2 id="è®¿é—®è€…æ¨¡å¼">è®¿é—®è€…æ¨¡å¼ <a href="#%e8%ae%bf%e9%97%ae%e8%80%85%e6%a8%a1%e5%bc%8f" class="anchor">ğŸ”—</a></h2><p>kubectlé‡Œæœ‰ä½¿ç”¨ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Visitor</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Visit</span>(<span style="color:#a6e22e">VisitorFunc</span>) <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">VisitorFunc</span> <span style="color:#66d9ef">func</span>(<span style="color:#f92672">*</span><span style="color:#a6e22e">Info</span>, <span style="color:#66d9ef">error</span>) <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">VisitorList</span> []<span style="color:#a6e22e">Visitor</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Visit implements Visitor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">l</span> <span style="color:#a6e22e">VisitorList</span>) <span style="color:#a6e22e">Visit</span>(<span style="color:#a6e22e">fn</span> <span style="color:#a6e22e">VisitorFunc</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">l</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">l</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">Visit</span>(<span style="color:#a6e22e">fn</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Visitor</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Visit</span>(<span style="color:#a6e22e">VisitorFunc</span>) <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">VisitorFunc</span> <span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">VisitorList</span> []<span style="color:#a6e22e">Vistor</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">l</span> <span style="color:#a6e22e">VisitorLList</span>)<span style="color:#a6e22e">Visit</span>(<span style="color:#a6e22e">fn</span> <span style="color:#a6e22e">VisitorFunc</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">l</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">l</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">Visit</span>(<span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;in visitorlist before fn&#34;</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">fn</span>()
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;in visitorlist after fn&#34;</span>)
</span></span><span style="display:flex;"><span>		}); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Visitor1</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> (<span style="color:#a6e22e">v</span> <span style="color:#a6e22e">Visitor1</span>) <span style="color:#a6e22e">Visit</span>(<span style="color:#a6e22e">fn</span> <span style="color:#a6e22e">VisitorFunc</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;in visitor1 before fn&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fn</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;in visitor1 after fn&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Visitor2</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">visitor</span> <span style="color:#a6e22e">Visitor</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">v</span> <span style="color:#a6e22e">Visitor2</span>) <span style="color:#a6e22e">Visit</span>(<span style="color:#a6e22e">fn</span> <span style="color:#a6e22e">VisitorFunc</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">visitor</span>.<span style="color:#a6e22e">Visit</span>(<span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">error</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;in visitor2 before fn&#34;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fn</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;in visitor2 after fn&#34;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Visitor3</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">visitor</span> <span style="color:#a6e22e">Visitor</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">v</span> <span style="color:#a6e22e">Visitor3</span>) <span style="color:#a6e22e">Visit</span>(<span style="color:#a6e22e">fn</span> <span style="color:#a6e22e">VisitorFunc</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">visitor</span>.<span style="color:#a6e22e">Visit</span>(<span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">error</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;in visitor3 before fn&#34;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fn</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;in visitor3 after fn&#34;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">visitor</span> <span style="color:#a6e22e">Visitor</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">visitors</span> []<span style="color:#a6e22e">Visitor</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">visitor</span> = <span style="color:#a6e22e">Visitor1</span>{}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">visitors</span> = append(<span style="color:#a6e22e">visitors</span>, <span style="color:#a6e22e">visitor</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">visitor</span> = <span style="color:#a6e22e">Visitor2</span>{<span style="color:#a6e22e">VisitorList</span>(<span style="color:#a6e22e">visitors</span>)}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">visitor</span> = <span style="color:#a6e22e">Visitor3</span>{<span style="color:#a6e22e">visitor</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">visitor</span>.<span style="color:#a6e22e">Visit</span>(<span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">error</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;In visitfunc&#34;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">in visitor1 before fn
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">in visitorlist before fn
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">in visitor2 before fn
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">in visitor3 before fn
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">in visistfunc
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">in  visitor3 after fn
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">in visitor2 after fn
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">in visitorlist after fn
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">in visitor1 after fn
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span></code></pre></div><h1 id="å¾®æœåŠ¡ä¸service-mesh">å¾®æœåŠ¡ä¸service mesh <a href="#%e5%be%ae%e6%9c%8d%e5%8a%a1%e4%b8%8eservice-mesh" class="anchor">ğŸ”—</a></h1><p>å¾®æœåŠ¡å†…éƒ¨æœ‰åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„é€šç”¨åŠŸèƒ½ï¼šç†”æ–­ç­–ç•¥ã€è´Ÿè½½å‡è¡¡ã€æœåŠ¡å‘ç°ã€è®¤è¯å’Œæˆæƒã€quotaé™åˆ¶ã€traceå’Œç›‘æ§ç­‰ç­‰</p>
<p>è¿™ç§å¾®æœåŠ¡å­˜åœ¨çš„é—®é¢˜ï¼š</p>
<ul>
<li>è™½ç„¶æœ‰ç°æˆçš„æ¡†æ¶åšäº†è¿™äº›äº‹æƒ…ï¼Œä½†åœ¨ä¹Ÿéœ€è¦ä¸šåŠ¡å»é…ç½®å’Œç®¡ç†æ¡†æ¶</li>
<li>è¿™äº›æ¡†æ¶libæˆ–è€…sdkç¼ºä¸šåŠ¡è¯­è¨€æ—¶ï¼Œå¾ˆéš¾èå…¥æˆ–è€…éœ€è¦å¼€å‘å¯¹åº”è¯­è¨€çš„åŒ…æ¥èå…¥å¾®æœåŠ¡å†…éƒ¨</li>
<li>æ¡†æ¶å‡çº§ï¼Œå¯¹ä¸šåŠ¡ä¸é€æ˜ï¼Œéœ€è¦ä¸šåŠ¡è‡ªè¡Œå‡çº§</li>
</ul>
<p>sidecar å•è¾¹æ¨¡å¼ä»£ç†æ¨¡å¼ã€‚ åŒä¸€ä¸ªå¾®æœåŠ¡çš„ä»£ç†è¿›ç¨‹service meshäº’é€šï¼Œä¸å…¶ä»–å¾®æœåŠ¡çš„service meshä¹Ÿé€šä¿¡ï¼Œæ‰€ä»¥å•çœ‹ä»£ç†è¿›ç¨‹åƒç½‘ä¸€æ ·ï¼Œæ‰€ä»¥å«service meshã€‚</p>
<h1 id="laas">laas <a href="#laas" class="anchor">ğŸ”—</a></h1><p>è™šæ‹ŸåŒ–æ¶æ„ï¼švmware ESXi
Xenæ¶æ„ï¼ˆXenå†…æ ¸ç®¡ç†CPUå’ŒMEMï¼ŒDeamonè™šæ‹Ÿæœºç®¡ç†netï¼Œdiskï¼‰
KVMæ¶æ„ï¼ˆKVMå†…æ ¸ç®¡ç†CPUå’ŒMEMï¼Œ QEMUç®¡ç†netï¼Œdiskï¼Œè™šæ‹Ÿæœºè¿›ç¨‹è°ƒåº¦ï¼‰</p>

    </div>

    
        <div class="tags">
            
                <a href="http://brettkk.github.io/tags/cloud">cloud</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    

    <script src="https://utteranc.es/client.js"
repo="brettKK/brettkk.github.io"
issue-term="title"
theme="github-light"
crossorigin="anonymous"
async>
</script>  

    <div class="copyright">
    
       Â© Copyright 
       2023 
       <span class="split">
        <svg fill="#bbbbbb" width="15" height="15" version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">
  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>
</svg>
       </span>
       
    
    </div>

    
      <div class="powerby">
        Powered by <a href='http://www.gohugo.io/'>Hugo</a> Theme By <a href='https://github.com/nodejh/hugo-theme-cactus-plus'>nodejh</a>
      </div>
    
</footer>




  </body>
</html>
