<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <title>golang | brettkk</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="">
<meta name="generator" content="Hugo 0.84.0" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link href="https://cdn.bootcss.com/highlight.js/9.15.10/styles/zenburn.min.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<link rel="stylesheet" href="http://brettkk.github.io/css/syntax.css" />


<link rel="stylesheet" href="/css/style.css">
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />








  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">â†</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">golang</h1>

    <div class="tip">
        <span>
          May 7, 2021 18:54
        </span>
        <span class="split">
          Â·
        </span>
        <span>
          
            2136 words
          
        </span>
        <span class="split">
          Â·
        </span>
        <span>
          5 minute read
        </span>
    </div>

    <div class="content">
      <h2 id="èµ„æ–™">èµ„æ–™ <a href="#%e8%b5%84%e6%96%99" class="anchor">ğŸ”—</a></h2><ol>
<li>
<p>ç›®å‰golangçš„ä¸»è¦maintainer: Russ Cox</p>
</li>
<li>
<p>ä¸ªäººä¸»é¡µï¼šswtch.com/~rsc/</p>
</li>
<li>
<p>awesome-goç³»åˆ—ï¼Œhttps://github.com/gocn/knowledge</p>
</li>
</ol>
<hr>
<h2 id="å¤šæ€ç»§æ‰¿-èŒƒå‹">å¤šæ€ï¼Œç»§æ‰¿ï¼Œ èŒƒå‹ <a href="#%e5%a4%9a%e6%80%81%e7%bb%a7%e6%89%bf-%e8%8c%83%e5%9e%8b" class="anchor">ğŸ”—</a></h2><p>golangä¸­é¢å‘å¯¹è±¡çš„å®ç°æ–¹å¼</p>
<h3 id="ç»§æ‰¿">ç»§æ‰¿ <a href="#%e7%bb%a7%e6%89%bf" class="anchor">ğŸ”—</a></h3><p>ç»„åˆç»“æ„ä½“ï¼Œä¸€ä¸ªç»“æ„ä½“åµŒå…¥å¦ä¸€ä¸ªç»“æ„ä½“ï¼Œèƒ½å¤Ÿå®ç°å¯¹åµŒå…¥ç»“æ„ä½“çš„å­—æ®µä»¥åŠå…¶å®ç°çš„æ–¹æ³•çš„ç»§æ‰¿ï¼Œ ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">type</span> <span class="nx">person</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">name</span> <span class="kt">string</span>
    <span class="nx">age</span>  <span class="kt">int</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">student</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">person</span> <span class="c1">//   åŒ¿åå­—æ®µï¼Œé€šè¿‡ç»„åˆçš„æ–¹å¼
</span><span class="c1"></span>    <span class="nx">school</span> <span class="kt">string</span> 
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">p</span> <span class="o">*</span> <span class="nx">person</span><span class="p">)</span> <span class="nf">talk</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">age</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">student</span><span class="p">)</span> <span class="nf">getSchool</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">school</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">s</span> <span class="o">:=</span> <span class="nx">student</span><span class="p">{</span><span class="nx">person</span><span class="p">{</span><span class="s">&#34;brettkk&#34;</span><span class="p">,</span> <span class="mi">18</span><span class="p">},</span> <span class="s">&#34;yidu&#34;</span><span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="c1">// ç»§æ‰¿personçš„nameå­—æ®µ
</span><span class="c1"></span>    <span class="nx">s</span><span class="p">.</span><span class="nf">talk</span><span class="p">()</span> <span class="c1">// ç»§æ‰¿personå®ç°çš„æ–¹æ³•
</span><span class="c1"></span><span class="p">}</span>

</code></pre></div><h3 id="å¤šæ€">å¤šæ€ <a href="#%e5%a4%9a%e6%80%81" class="anchor">ğŸ”—</a></h3><p>goæ²¡æœ‰ implements, extends å…³é”®å­—ï¼Œ golangæ˜¯å»é¸­å­ç±»å‹ï¼šçœ‹èµ·æ¥åƒé¸­å­ï¼Œ é‚£ä¹ˆå®ƒå°±æ˜¯é¸­å­ã€‚</p>
<p>å¤šæ€ï¼š çˆ¶ç±»æŒ‡é’ˆæˆ–å¼•ç”¨å»è°ƒç”¨æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œèƒ½å¤Ÿæ ¹æ®å­ç±»çš„ç±»å‹å»æ‰§è¡Œå­ç±»å½“ä¸­çš„æ–¹æ³•ã€‚</p>
<p>ä¸ºä»€ä¹ˆæ˜¯åœ¨æ‰§è¡Œçš„æ—¶å€™æ‰èƒ½æ ¹æ®å­ç±»çš„ç±»å‹æ‰§è¡Œå­ç±»çš„æ–¹æ³•ï¼Ÿ</p>
<div class="highlight"><pre class="chroma"><code class="language-golang" data-lang="golang">
<span class="kd">type</span> <span class="nx">Person</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">gender</span><span class="p">()</span> <span class="kt">string</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">Men</span> <span class="kd">struct</span><span class="p">{</span>
    <span class="nx">Gender</span> <span class="kt">string</span>
    <span class="nx">Age</span> <span class="kt">int</span>
    <span class="nx">Name</span> <span class="kt">string</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">Woman</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Gender</span> <span class="kt">string</span>
    <span class="nx">Age</span> <span class="kt">int</span>
    <span class="nx">Name</span> <span class="nx">strings</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="nx">Men</span><span class="p">)</span> <span class="nf">gender</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">m</span><span class="p">.</span><span class="nx">Gender</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">w</span> <span class="nx">Woman</span><span class="p">)</span> <span class="nf">gender</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">w</span><span class="p">.</span><span class="nx">Gender</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">JudgeFunc</span><span class="p">()</span> <span class="kt">bool</span> <span class="p">{</span>
    <span class="c1">// may has many code
</span><span class="c1"></span>    <span class="c1">// can&#39;t not get boolean result until running this JudgeFunc
</span><span class="c1"></span><span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">a</span> <span class="nx">Person</span>
    <span class="c1">// so compiler can&#39;t not known clearly about the type info of a
</span><span class="c1"></span>    <span class="nx">a</span> <span class="p">=</span> <span class="nf">JudgeFunc</span><span class="p">()</span> <span class="err">?</span> <span class="nx">Men</span><span class="p">{}</span> <span class="p">:</span> <span class="nx">Woman</span><span class="p">{}</span>

    <span class="kd">var</span> <span class="nx">b</span> <span class="nx">Person</span>
    <span class="c1">// compiler can judge the type info of a 
</span><span class="c1"></span>    <span class="nx">b</span> <span class="p">=</span> <span class="nx">Men</span><span class="p">{}</span> <span class="c1">// or b = Woman{}
</span><span class="c1"></span><span class="p">}</span>

</code></pre></div><h3 id="èŒƒå‹">èŒƒå‹ <a href="#%e8%8c%83%e5%9e%8b" class="anchor">ğŸ”—</a></h3><p>ç©ºinterface{} ç±»å‹ï¼Œæ²¡æœ‰æ–¹æ³•é›†çš„æ¥å£ï¼Œåªéœ€è¦å­˜ç±»å‹å’Œç±»å‹å¯¹åº”çš„å€¼å³å¯ã€‚</p>
<p>ç©ºinterface{} = (type, value) ==&gt; (nil, nil) == nil</p>
<div class="highlight"><pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">type</span> <span class="nx">eface</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">_type</span> <span class="o">*</span><span class="nx">_type</span>
	<span class="nx">data</span>  <span class="nx">unsafe</span><span class="p">.</span><span class="nx">Pointer</span>
<span class="p">}</span>

</code></pre></div><h3 id="æ¥å£çš„ä½¿ç”¨å®è·µ">æ¥å£çš„ä½¿ç”¨å®è·µ <a href="#%e6%8e%a5%e5%8f%a3%e7%9a%84%e4%bd%bf%e7%94%a8%e5%ae%9e%e8%b7%b5" class="anchor">ğŸ”—</a></h3><p>golangæºç é‡Œçš„è¾ƒå¥½å®ç°æ–¹å¼æ˜¯ï¼š ä½¿ç”¨å°çš„æ¥å£ï¼Œå°¤å…¶æ˜¯åªåŒ…å«ä¸€ä¸ªæ–¹æ³•çš„æ¥å£ï¼›é€šè¿‡å°æ¥å£çš„ç»„åˆæ¥å®šä¹‰å¤§æ¥å£ã€‚</p>
<p>å¥½å¤„æ˜¯ï¼šä½¿ç”¨è€…å¯ä»¥åªä¾èµ–äºå¿…è¦åŠŸèƒ½çš„æœ€å°æ¥å£ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">type</span> <span class="nx">Reader</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nf">Read</span><span class="p">(</span><span class="nx">p</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">Writer</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nf">Write</span><span class="p">(</span><span class="nx">p</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">ReadWriter</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nx">Reader</span>
    <span class="nx">Writer</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">store</span><span class="p">(</span><span class="nx">reader</span> <span class="nx">Reader</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="c1">// å…¥å‚å¯ä»¥åªä¾èµ–äºå¿…è¦åŠŸèƒ½çš„æœ€å°æ¥å£ï¼Œ è®©å‡½æ•°çš„è¿”å›æ›´å¹¿
</span><span class="c1"></span><span class="p">}</span>
<span class="kd">func</span> <span class="nf">store</span><span class="p">(</span><span class="nx">readWriter</span> <span class="nx">ReadWriter</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="c1">// å…¥å‚ä¾èµ–äº†ä¸å¿…è¦åŠŸèƒ½çš„æ¥å£ï¼Œè®©é™åˆ¶äº†å‡½æ•°çš„ä½¿ç”¨èŒƒå›´ä¸ºæ›´å°
</span><span class="c1"></span><span class="p">}</span>

</code></pre></div><h2 id="æ¨¡ç³Šç‚¹">æ¨¡ç³Šç‚¹ <a href="#%e6%a8%a1%e7%b3%8a%e7%82%b9" class="anchor">ğŸ”—</a></h2><h3 id="æ•°ç»„ä¸åˆ‡ç‰‡">æ•°ç»„ä¸åˆ‡ç‰‡ <a href="#%e6%95%b0%e7%bb%84%e4%b8%8e%e5%88%87%e7%89%87" class="anchor">ğŸ”—</a></h3><p>æ•°ç»„çš„åˆå§‹åŒ– ï¼ˆå…ƒç´ ç±»å‹ï¼Œ æ•°ç»„å¤§å°ï¼‰</p>
<p>2ç§åˆå§‹åŒ–æ–¹å¼ï¼Œæ˜¾å¼çš„æŒ‡å®šæ•°ç»„çš„å¤§å°</p>
<ol>
<li>arr := [3]int{1, 2, 3}</li>
<li>[...]T å£°æ˜æ•°ç»„ // arr := [...]int{1, 2, 3}</li>
</ol>
<br/>
<h3 id="å‡½æ•°çš„æ¥å—è€…">å‡½æ•°çš„æ¥å—è€… <a href="#%e5%87%bd%e6%95%b0%e7%9a%84%e6%8e%a5%e5%8f%97%e8%80%85" class="anchor">ğŸ”—</a></h3><p>å‡½æ•°æ¥å—è€…ä¸ºæŒ‡é’ˆç±»å‹:</p>
<ol>
<li>å‡½æ•°å¯ä»¥ä¿®æ”¹æ¥å—è€…çš„å†…å®¹</li>
<li>é¿å…æ–¹æ³•è°ƒç”¨æ—¶å˜é‡çš„æ‹·è´ï¼Œè€Œæ˜¯æŒ‡é’ˆçš„æ‹·è´</li>
</ol>
<br/>
<h3 id="golangå€¼æ‹·è´">golangå€¼æ‹·è´ <a href="#golang%e5%80%bc%e6%8b%b7%e8%b4%9d" class="anchor">ğŸ”—</a></h3><p>goä¸¥æ ¼ä¸Šåªæœ‰å¤åˆ¶æ‹·è´ä¼ é€’</p>
<p>æ€»æ˜¯åˆ›å»ºå‰¯æœ¬æŒ‰å€¼ä¼ é€’ï¼Œåªä¸è¿‡è¿™ä¸ªå‰¯æœ¬å¯ä»¥æ˜¯å˜é‡çš„å‰¯æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯æŒ‡é’ˆçš„å‰¯æœ¬</p>
<br/>
<h3 id="é—­åŒ…">é—­åŒ… <a href="#%e9%97%ad%e5%8c%85" class="anchor">ğŸ”—</a></h3><p>é—­åŒ…=å‡½æ•°+å¼•ç”¨ç¯å¢ƒã€‚</p>
<p>é—­åŒ…é‡Œå¼•ç”¨å±€éƒ¨å˜é‡æ—¶ï¼Œåœ¨å †ä¸Šåˆ›å»ºè¯¥å˜é‡çš„ä¸€ä¸ªæ‹·è´ï¼Œå¹¶æŠŠè¯¥å˜é‡åœ°å€å’Œå‡½æ•°é—­åŒ…ç»„æˆä¸€ä¸ªç»“æ„ä½“ï¼Œå¹¶æŠŠè¯¥ç»“æ„ä½“ä¼ å‡ºæ¥ä½œä¸ºè¿”å›å€¼</p>
<br/>
<h3 id="unsafeåŒ…">unsafeåŒ… <a href="#unsafe%e5%8c%85" class="anchor">ğŸ”—</a></h3><p>uintpträ¸unsafe.Pointerï¼ˆç±»ä¼¼void*ï¼‰</p>
<ol>
<li>T1æŒ‡é’ˆä¸ T2æŒ‡é’ˆç±»å‹ä¹‹é—´çš„è½¬æ¢</li>
<li>ä¿®æ”¹å†…å­˜æ•°æ®ï¼Œ uintptr å¸¸ç”¨äºä¸ unsafe.Pointeré…åˆï¼Œç”¨äºåšæŒ‡é’ˆè¿ç®—</li>
</ol>
<div class="highlight"><pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">//ç»“æ„ä½“çš„æˆå‘˜å˜é‡åœ¨å†…å­˜å­˜å‚¨ä¸Šæ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Num</span> <span class="kd">struct</span><span class="p">{</span>
	<span class="nx">i</span> <span class="kt">string</span>
	<span class="nx">j</span> <span class="kt">int64</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="nx">n</span> <span class="o">:=</span> <span class="nx">Num</span><span class="p">{</span><span class="nx">i</span><span class="p">:</span> <span class="s">&#34;EDDYCJY&#34;</span><span class="p">,</span> <span class="nx">j</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
	<span class="nx">nPointer</span> <span class="o">:=</span> <span class="nx">unsafe</span><span class="p">.</span><span class="nf">Pointer</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">n</span><span class="p">)</span>
	<span class="c1">// ç»“æ„ä½“çš„åˆå§‹åœ°å€å°±æ˜¯ç¬¬ä¸€ä¸ªæˆå‘˜å˜é‡çš„å†…å­˜åœ°å€
</span><span class="c1"></span>	<span class="nx">niPointer</span> <span class="o">:=</span> <span class="p">(</span><span class="o">*</span><span class="kt">string</span><span class="p">)(</span><span class="nx">unsafe</span><span class="p">.</span><span class="nf">Pointer</span><span class="p">(</span><span class="nx">nPointer</span><span class="p">))</span>
	<span class="o">*</span><span class="nx">niPointer</span> <span class="p">=</span> <span class="s">&#34;wuhan&#34;</span>
	<span class="c1">// åŸºäºç»“æ„ä½“çš„æˆå‘˜åœ°å€å»è®¡ç®—åç§»é‡ã€‚å°±èƒ½å¤Ÿå¾—å‡ºå…¶ä»–æˆå‘˜å˜é‡çš„å†…å­˜åœ°å€
</span><span class="c1"></span>	<span class="c1">//uintptr æ˜¯ Go çš„å†…ç½®ç±»å‹ã€‚è¿”å›æ— ç¬¦å·æ•´æ•°ï¼Œå¯å­˜å‚¨ä¸€ä¸ªå®Œæ•´çš„åœ°å€ã€‚åç»­å¸¸ç”¨äºæŒ‡é’ˆè¿ç®—
</span><span class="c1"></span>	<span class="c1">//unsafe.Offsetofï¼šè¿”å›æˆå‘˜å˜é‡ x åœ¨ç»“æ„ä½“å½“ä¸­çš„åç§»é‡ã€‚æ›´å…·ä½“çš„è®²ï¼Œå°±æ˜¯è¿”å›ç»“æ„ä½“åˆå§‹ä½ç½®åˆ° x ä¹‹é—´çš„å­—èŠ‚æ•°
</span><span class="c1"></span>	<span class="c1">//uintptr ç±»å‹æ˜¯ä¸èƒ½å­˜å‚¨åœ¨ä¸´æ—¶å˜é‡ä¸­çš„ ä¸´æ—¶å˜é‡æ˜¯å¯èƒ½è¢«åƒåœ¾å›æ”¶æ‰çš„ ä¹‹åçš„å†…å­˜æ“ä½œæœ‰è¿·èŒ«äº†
</span><span class="c1"></span>	<span class="nx">njPointer</span> <span class="o">:=</span> <span class="p">(</span><span class="o">*</span><span class="kt">int64</span><span class="p">)(</span><span class="nx">unsafe</span><span class="p">.</span><span class="nf">Pointer</span><span class="p">(</span><span class="nb">uintptr</span><span class="p">(</span><span class="nx">nPointer</span><span class="p">)</span> <span class="o">+</span> <span class="nx">unsafe</span><span class="p">.</span><span class="nf">Offsetof</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">j</span><span class="p">)))</span>
	<span class="o">*</span><span class="nx">njPointer</span> <span class="p">=</span> <span class="mi">91</span>

	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;n.i: %s, n.j: %d&#34;</span><span class="p">,</span> <span class="nx">n</span><span class="p">.</span><span class="nx">i</span><span class="p">,</span> <span class="nx">n</span><span class="p">.</span><span class="nx">j</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>æŒ‡é’ˆæ˜¯å¯¹å†…å­˜åŒºåŸŸçš„åœ°å€ï¼Œ ä¸æŒ‡é’ˆç›¸é…åˆçš„ç±»å‹
è¯´æ˜åŒºåŸŸæœ‰å“ªäº›å±æ€§ï¼Œå¦‚ä½•å»è§£æã€‚</p>
<br/>
<h3 id="nil">nil <a href="#nil" class="anchor">ğŸ”—</a></h3><ul>
<li>what is nil
<ul>
<li>nil is a kind of zero</li>
</ul>
</li>
<li>what is nil in go
<ul>
<li>å„ç§ç±»å‹çš„é›¶å€¼</li>
<li>åŸºæœ¬ç±»å‹çš„é›¶å€¼ä¸ä¸ºnil
<ul>
<li>boolä¸ºfalse</li>
<li>numberä¸º0</li>
<li>stringä¸º&quot;&quot;</li>
</ul>
</li>
<li>éåŸºæœ¬ç±»å‹çš„é›¶å€¼ä¸ºnil
<ul>
<li>pointer, slice, map, channel, function, interface{} ==&gt; nil</li>
<li>interface{}ç±»å‹ éœ€è¦typeå’Œvalueå‡ä¸ºnilæ—¶ï¼Œæ‰ä¼šä¸ºnil</li>
<li>structure{}ï¼Œå› ä¸ºæœ‰ç»“æ„typeå­˜åœ¨ï¼Œtypeä¸ä¸ºnilï¼Œæ‰€ä»¥ç»“æ„ä½“å˜é‡ä¸ä¼šæ˜¯nil</li>
</ul>
</li>
</ul>
</li>
</ul>
<br/>
<h3 id="åå°„">åå°„ <a href="#%e5%8f%8d%e5%b0%84" class="anchor">ğŸ”—</a></h3><p>åå°„ Reflection ï¼Œinterfaceå¯¹è±¡=ï¼ˆType, Valueï¼‰</p>
<p>åå°„ç±»å‹ reflect.Type, reflect.Value)</p>
<p>ä¸‰ç§åå°„çš„åŸºæœ¬æ“ä½œï¼š</p>
<ol>
<li>åå°„å¯ä»¥å°†interfaceç±»å‹çš„å˜é‡ è½¬æ¢ä¸º åå°„å¯¹è±¡ï¼ˆreflect.Type reflect.Valueï¼‰</li>
<li>åå°„å¯ä»¥å°†åå°„å¯¹è±¡ è¿˜åŸä¸ºinterfaceå¯¹è±¡</li>
<li>åå°„å¯¹è±¡å¯ä»¥ä¿®æ”¹ï¼Œæå‰æ˜¯valueå€¼æ˜¯å˜é‡çš„æŒ‡é’ˆ</li>
</ol>
<div class="highlight"><pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">var</span> <span class="nx">x</span> <span class="kt">float</span><span class="p">=</span> <span class="mf">3.1</span> 
<span class="nx">v</span><span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">x</span><span class="p">)</span> <span class="c1">//éœ€è¦ä¼ å…¥xçš„æŒ‡é’ˆ
</span><span class="c1"></span><span class="nx">v</span><span class="p">.</span><span class="nf">Elem</span><span class="p">().</span><span class="nf">SetFloat</span><span class="p">(</span><span class="mf">3.4</span><span class="p">);</span>
</code></pre></div><p>ä½œç”¨ï¼š</p>
<ol>
<li>è¿è¡Œæ—¶åŠ¨æ€è°ƒç”¨æ–¹æ³•</li>
<li>è¿è¡Œæ—¶æ„é€ å‡½æ•°è¿›è¡Œmockæ’æ¡©</li>
</ol>
<br/>
<h3 id="å†…å­˜ç®¡ç†">å†…å­˜ç®¡ç† <a href="#%e5%86%85%e5%ad%98%e7%ae%a1%e7%90%86" class="anchor">ğŸ”—</a></h3><ol>
<li>åŸºæœ¬æƒ³æ³•ï¼šå±€éƒ¨Pä¸Šï¼ˆper cpuï¼‰å’Œå…¨å±€é˜Ÿåˆ—æƒ³ç»“åˆçš„å‡è¡¡æ€æƒ³ã€‚å±€éƒ¨åˆ†é…æ— éœ€åŠ é”ï¼Œå±€éƒ¨åˆ†é…æ— æ³•æ»¡è¶³æ—¶åŠ é”å…¨å±€åˆ†é…</li>
</ol>
<ul>
<li>src/runtime/mheap.go:mspan</li>
<li>å†…å­˜å›æ”¶åŸç†
<ul>
<li>ä¸‰è‰²æ ‡è®°æ³• ï¼ˆæœªä½¿ç”¨ï¼Œå·²ä½¿ç”¨ï¼Œå¸¦å¤„ç†ï¼‰</li>
<li>rootå¯¹è±¡å¼€å§‹ï¼ŒBFSéå†æ ‡è®°ï¼Œ</li>
</ul>
</li>
<li>é€ƒé€¸åˆ†æï¼ˆå¯¹è±¡æ˜¯å¦è¢«å‡½æ•°å¤–é¢å¼•ç”¨ ä¾‹å¦‚é—­åŒ…ï¼› å¯¹è±¡è¿‡å¤§ä¹Ÿå¯èƒ½åœ¨å †ä¸­ï¼‰
<ul>
<li>é€ƒé€¸åˆ†æçš„ç›®çš„æ˜¯å†³å®šå˜é‡çš„å†…å­˜åˆ†é…åœ°å€æ˜¯åœ¨æ ˆè¿˜æ˜¯å †</li>
<li>é€ƒé€¸åˆ†æåœ¨ç¼–è¯‘é˜¶æ®µå®Œæˆçš„</li>
<li>ä¼ é€’æŒ‡é’ˆçœŸçš„æ¯”ä¼ å€¼é«˜æ•ˆå—ï¼Ÿä¸ä¸€å®š ç”±äºæŒ‡é’ˆä¼ é€’ä¼šäº§ç”Ÿé€ƒé€¸ï¼Œå¯èƒ½ä¼šä½¿ç”¨å †ï¼Œå¢åŠ GCè´Ÿæ‹…ã€‚</li>
<li>go build -gcflags=-m // escapes to heap</li>
</ul>
</li>
</ul>
<br/>
<h2 id="go-æ±‡ç¼–">go æ±‡ç¼– <a href="#go-%e6%b1%87%e7%bc%96" class="anchor">ğŸ”—</a></h2><p>Generate x86 Assembly with Go</p>
<p><a href="https://github.com/mmcloughlin/avo">https://github.com/mmcloughlin/avo</a></p>
<ul>
<li>æ±‡ç¼–é£æ ¼åˆ†ä¸º2ç±»</li>
</ul>
<ol>
<li>intelé£æ ¼</li>
<li>AT&amp;Té£æ ¼(å·¦ --&gt; å³) goæ˜¯plan9ï¼Œ å±äºæ­¤ç±»</li>
</ol>
<ul>
<li>
<p>åŠ©è®°ç¬¦    call, add</p>
</li>
<li>
<p>register  ax, sb, pc</p>
</li>
<li>
<p>ç«‹å³æ•° $1 , $0x100</p>
</li>
<li>
<p>å†…å­˜å¯»å€ ï¼ˆR1ï¼‰</p>
</li>
<li>
<p>plan 9</p>
<ul>
<li><a href="https://lrita.github.io/2017/12/12/golang-asm/#go%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8">https://lrita.github.io/2017/12/12/golang-asm/#go%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8</a></li>
<li><a href="https://lrita.github.io/images/posts/go/GoFunctionsInAssembly.pdf">https://lrita.github.io/images/posts/go/GoFunctionsInAssembly.pdf</a></li>
<li><a href="https://github.com/buptbill220/gotls/tree/master/interesting">https://github.com/buptbill220/gotls/tree/master/interesting</a></li>
<li>æŸ¥çœ‹å½“å‰cpuæ¶æ„çš„æŒ‡ä»¤é›†åˆ cat /proc/cpuinfo | grep flags | head -1</li>
<li>æŒ‡ä»¤æŸ¥è¯¢ï¼š <a href="http://68k.hax.com/">http://68k.hax.com/</a></li>
<li>å‘½ä»¤æŸ¥è¯¢ï¼šhttps://9p.io/magic/man2html/1/8a</li>
<li>plan9 æ–‡æ¡£ï¼š <a href="https://9p.io/sys/doc/">https://9p.io/sys/doc/</a></li>
</ul>
</li>
<li>
<p><a href="https://defuse.ca/online-x86-assembler.htm#disassembly2">https://defuse.ca/online-x86-assembler.htm#disassembly2</a></p>
<ul>
<li>x86 or x64 assembly instructions encoding&lt;==&gt; decoding binary code</li>
<li>It uses GCC and objdump behind the scenes</li>
</ul>
</li>
<li>
<p>goroot/src/syscall --ã€‹ å»ºè®®ä½¿ç”¨ golang.org/x/sys</p>
</li>
</ul>

    </div>

    
        <div class="tags">
            
                <a href="http://brettkk.github.io/tags/golang">golang</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    

    <p class="copyright">
    
       Â© Copyright 
       2021 
       <span class="split">
        <svg fill="#bbbbbb" width="15" height="15" version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">
  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>
</svg>
       </span>
       
    
    </p>
    <p class="powerby">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
    </p>
</footer>

  </body>
</html>
